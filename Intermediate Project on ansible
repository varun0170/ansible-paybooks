#Task#
Create a playbook that:

Installs nginx only on nodes tagged as "web"

Sets up a custom index.html using a Jinja2 template

Restarts nginx only when the template changes

Uses variables for package names and ports

Encrypts AWS keys using Ansible Vault

Uses dynamic inventory (aws_ec2.yml)

#step:1#  aws_ec2.yml — Dynamic Inventory Config
plugin: aws_ec2
regions:
  - us-east-1
keyed_groups:
  - key: tags.Name
    prefix: tag
filters:
  tag:Role: web  # Only fetch instances tagged with Role=web
hostnames:
  - public-ip-address

#step:2#   playbook.yml — Main Playbook
- name: Configure Web Servers
  hosts: tag_Role_web
  become: true
  vars_files:
    - vars/main.yml
    - secrets/vault.yml

  tasks:
    - name: Install nginx
      apt:
        name: "{{ web_package }}"
        state: present
        update_cache: true

    - name: Deploy custom index.html
      template:
        src: templates/index.html.j2
        dest: /var/www/html/index.html
        owner: www-data
        group: www-data
        mode: '0644'
      notify: Restart nginx

  handlers:
    - name: Restart nginx
      service:
        name: nginx
        state: restarted
